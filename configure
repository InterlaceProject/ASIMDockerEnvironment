#!/bin/bash
BUILD_ICEF=${1:-"nobuild"}

if [ -d "ASIMSpec" ]; then
  echo "Updateing ASIMSpec repository..."
  cd ASIMSpec
  git pull
  cd ..
else
  echo "Cloneing ASIMSpec repository..."
  git clone https://github.com/InterlaceProject/ASIMSpec
  echo "ASIMSpec cloned."
fi

if [ -d "icef" ]; then
  echo "Updateing ICEF repository..."
  cd icef
  git pull
  cd ..
else
  echo "Cloneing ICEF repository..."
  git clone https://github.com/biomics/icef.git icef
  echo "ICEF cloned."

  BUILD_ICEF="rebuild"
fi
# build container
docker build -t asim .

# build framework
if [ "$BUILD_ICEF" == "rebuild" ]; then
  ./execute /home/buildICEFDocker.sh
fi
